(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirmation"],{"4d10":function(e,t,s){"use strict";s.r(t);var i=s("bc60"),a=s.n(i);for(var r in i)"default"!==r&&function(e){s.d(t,e,function(){return i[e]})}(r);t["default"]=a.a},"67cf":function(e,t,s){"use strict";var i=s("ece6"),a=s.n(i);a.a},8395:function(e,t,s){"use strict";s("6a7a");var i=r(s("b0ce")),a=r(s("a6f1"));function r(e){return e&&e.__esModule?e:{default:e}}Page((0,i.default)(a.default))},a6f1:function(e,t,s){"use strict";s.r(t);var i=s("d2b6"),a=s("4d10");for(var r in a)"default"!==r&&function(e){s.d(t,e,function(){return a[e]})}(r);s("67cf");var c=s("2877"),n=Object(c["a"])(a["default"],i["a"],i["b"],!1,null,null,null);t["default"]=n.exports},bc60:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={data:function(){return{orderItemList:[],totalPrice:0,sumPrice:0,shippingFee:0,userRemark:"",credit:0,deduction:0,selectedAddress:null}},onShow:function(){var t=this;e.getStorage({key:"cart-list-to-confirm",success:function(e){t.orderItemList=e.data,t.totalPrice=0,t.shippingFee=0;for(var s=t.orderItemList.length,i=0;i<s;i++)t.totalPrice+=t.orderItemList[i].amount*t.orderItemList[i].product.price,t.orderItemList[i].product.isFreeShipping||(t.shippingFee+=t.orderItemList[i].product.shippingFee);t.deduction=t.credit/100,t.sumPrice=t.totalPrice+t.shippingFee,t.sumPrice=t.sumPrice.toFixed(2),t.totalPrice=t.totalPrice.toFixed(2),t.shippingFee=t.shippingFee.toFixed(2),t.deduction=t.deduction.toFixed(2)}});var s=e.getStorageSync("selectedAddress");s?(this.selectedAddress=s,e.removeStorageSync("selectedAddress")):this.loadDefaultAddress()},onHide:function(){this.clearOrder()},onBackPress:function(){this.clearOrder()},methods:{clearOrder:function(){var t=this;e.removeStorage({key:"orderItemList",success:function(e){t.orderItemList=[],console.log("remove orderItemList success")}})},loadDefaultAddress:function(){var t=this;this.$pin.request("GET","/commons/user/default-address",null,function(e){t.selectedAddress=e.data.defaultAddress},function(t){e.showToast({title:"加载默认地址失败"})})},toPay:function(){for(var t=this,s=[],i=0;i<this.orderItemList.length;i++)s.push(this.orderItemList[i].id);e.showLoading({title:"正在提交订单..."}),this.$pin.request("POST","/commons/order/order-individual",{addressId:this.selectedAddress.id,orderItemIds:s,userRemark:this.userRemark},function(t){e.hideLoading(),e.showToast({title:"创建订单完成"})},function(t){e.hideLoading(),e.showToast({icon:"none",title:"创建订单失败"})}),setTimeout(function(){e.setStorage({key:"paymentOrder",data:paymentOrder,success:function(){e.hideLoading(),e.redirectTo({url:"../pay/payment/payment?amount="+t.sumPrice})}})},1e3)},selectAddress:function(){e.navigateTo({url:"../user/address/address?type=select"})}}};t.default=s}).call(this,s("543d")["default"])},d2b6:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",[s("view",{staticClass:"pin-list-item",attrs:{eventid:"3650773f-0"},on:{tap:e.selectAddress}},[s("view",{staticClass:"list-left"},[s("i",{staticClass:"pin-icon"},[e._v("location_on")])],1),null!=e.selectedAddress?s("view",{staticClass:"list-right"},[s("view",{staticClass:"list-header"},[s("view",{staticClass:"list-title"},[e._v(e._s(e.selectedAddress.realName))]),s("view",{staticClass:"list-sub-title"},[e._v(e._s(e.selectedAddress.phone))])]),s("view",{staticClass:"list-detail"},[e._v(e._s(e.selectedAddress.province)+" "+e._s(e.selectedAddress.detail)+"\n\t\t\t\t"+e._s(e.selectedAddress.detailed))])]):s("view",{staticClass:"list-right"},[e._m(0),s("view",{staticClass:"list-detail"},[e._v("点此创建/编辑默认收货地址")])])]),s("view",{staticClass:"buy-list"},e._l(e.orderItemList,function(t,i){return s("view",{key:i,staticClass:"row"},[s("view",{staticClass:"goods-info"},[s("view",{staticClass:"img"},[s("image",{attrs:{mode:"aspectFill",src:t.product.imageUrls}})]),s("view",{staticClass:"info"},[s("view",{staticClass:"title"},[e._v(e._s(t.product.name))]),s("view",{staticClass:"spec"},[e._v("规格"+e._s(t.productAttributeValue.sku))]),s("view",{staticClass:"price-number"},[s("view",{staticClass:"price"},[e._v("￥"+e._s(t.product.price*t.amount))]),s("view",{staticClass:"number"},[e._v("× "+e._s(t.amount))])])])])])})),s("view",{staticClass:"order"},[s("view",{staticClass:"row"},[s("view",{staticClass:"left"},[e._v("积分")]),s("view",{staticClass:"right"},[e._v("可使用 "+e._s(e.credit)+" 积分抵扣 ￥"+e._s(e.deduction)+" 元")])]),s("view",{staticClass:"row"},[s("view",{staticClass:"left"},[e._v("备注")]),s("view",{staticClass:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userRemark,expression:"userRemark"}],attrs:{placeholder:"备注内容(选填)",eventid:"3650773f-1"},domProps:{value:e.userRemark},on:{input:function(t){t.target.composing||(e.userRemark=t.target.value)}}})])])]),s("view",{staticClass:"detail"},[s("view",{staticClass:"row"},[s("view",{staticClass:"nominal"},[e._v("商品金额")]),s("view",{staticClass:"content"},[e._v("￥"+e._s(e.totalPrice))])]),s("view",{staticClass:"row"},[s("view",{staticClass:"nominal"},[e._v("运费")]),s("view",{staticClass:"content"},[e._v("+ ￥"+e._s(e.shippingFee))])]),s("view",{staticClass:"row"},[s("view",{staticClass:"nominal"},[e._v("积分抵扣")]),s("view",{staticClass:"content"},[e._v("- ￥"+e._s(e.deduction))])])]),s("view",{staticClass:"blck"}),s("view",{staticClass:"footer"},[s("view",{staticClass:"settlement"},[s("view",{staticClass:"sum"},[e._v("合计:"),s("view",{staticClass:"money"},[e._v("￥"+e._s(e.sumPrice))])]),s("view",{staticClass:"pin-button",attrs:{eventid:"3650773f-2"},on:{tap:e.toPay}},[e._v("提交订单")])])])])},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"list-header"},[s("view",{staticClass:"list-title"},[e._v("您未创建默认地址")])])}];s.d(t,"a",function(){return i}),s.d(t,"b",function(){return a})},ece6:function(e,t,s){}},[["8395","common/runtime","common/vendor"]]]);